<?xml version="1.0"?>

<!--
Copyright (C) 2014-2018 Greenbone Networks GmbH

SPDX-License-Identifier: GPL-2.0-or-later

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
-->

<protocol>
  <name>Open Scanner Protocol</name>
  <abbreviation>OSP</abbreviation>
  <summary>The Open Scanner Protocol</summary>
  <version>1.2</version>

  <!-- Types. -->

  <type>
    <name>boolean</name>
    <summary>0 or 1</summary>
    <pattern>
      <e>xsd:token { pattern = "[01]" }</e>
    </pattern>
  </type>
  <type>
    <name>epoch_time</name>
    <summary>A date, in unix format</summary>
    <pattern>
      <e>integer</e>
    </pattern>
  </type>
  <type>
    <name>integer</name>
    <summary>An integer</summary>
    <pattern>
      <e>integer</e>
    </pattern>
  </type>
  <type>
    <name>status</name>
    <summary>Status code describing the result of a command</summary>
    <pattern>
      <e>xsd:token { pattern = "[1-5][0-9][0-9]" }</e>
    </pattern>
  </type>
  <type>
    <name>string</name>
    <summary>A string</summary>
    <pattern>
      <e>text</e>
    </pattern>
  </type>
  <type>
    <name>uuid</name>
    <summary>A Universally Unique Identifier (UUID)</summary>
    <pattern>
      <e>xsd:token { pattern = "[0-9abcdefABCDEF\-]{1,40}" }</e>
    </pattern>
  </type>
  <type>
    <name>vt_id</name>
    <summary>Identifier for a vulnerability test</summary>
    <pattern>
      <e>xsd:token { pattern = "[0-9a-zA-Z_\-.:]{1,80}" }</e>
    </pattern>
  </type>

  <!-- Elements. -->

  <element>
    <name>credential</name>
    <summary>A credential consisting of type, service, port, username and password.</summary>
    <pattern>
      <attrib>
        <name>type</name>
        <type>string</type>
        <required>1</required>
      </attrib>
      <attrib>
        <name>service</name>
        <type>string</type>
        <required>1</required>
      </attrib>
      <attrib>
        <name>port</name>
        <type>string</type>
      </attrib>
      <e>username</e>
      <e>password</e>
    </pattern>
    <ele>
      <name>username</name>
      <pattern>text</pattern>
    </ele>
    <ele>
      <name>password</name>
      <pattern>text</pattern>
    </ele>
    <example>
      <summary>Credential with port</summary>
      <e>
        <credential type="up" service="ssh" port="22">
          <username>scanuser</username>
          <password>mypass</password>
        </credential>
      </e>
    </example>
    <example>
      <summary>Credential without port</summary>
      <e>
        <credential type="up" service="smb">
          <username>smbuser</username>
          <password>mypass</password>
        </credential>
      </e>
    </example>
  </element>

  <element>
    <name>scanner_params</name>
    <summary>Contains elements that represent scanner specific parameters</summary>
    <pattern>
      <e>e</e>
    </pattern>
    <ele>
      <name>e</name>
      <summary>Element that represents a scanner specific parameters</summary>
      <type>string</type>
      <pattern>string</pattern>
    </ele>
    <example>
      <summary>scanner_params</summary>
      <e>
        <scanner_params>
          <target_port>443</target_port>
          <use_https>1</use_https>
          <profile>fast_scan</profile>
        </scanner_params>
      </e>
    </example>
  </element>

  <element>
    <name>targets</name>
    <summary>List of targets</summary>
    <pattern>
      <e>target</e>
    </pattern>
    <example>
      <summary>Two targets</summary>
      <e>
        <targets>
          <target>...</target>
          <target>...</target>
        </targets>
      </e>
    </example>
  </element>

  <element>
    <name>target</name>
    <summary>A scan target consisting of hosts, a port selection and credentials</summary>
    <pattern>
      <e>hosts</e>
      <e>ports</e>
      <e>credentials</e>
    </pattern>
    <ele>
      <name>hosts</name>
      <summary>One or many hosts. The list is comma-separated. Each entry can be a IP address, a CIDR notation, a hostname, a IP range. IPs can be v4 or v6</summary>
      <type>string</type>
    </ele>
    <ele>
      <name>ports</name>
      <type>string</type>
      <summary>A list of ports that is the same for the given hosts</summary>
    </ele>
    <ele>
      <name>credentials</name>
      <summary>One or many credentials containing the credential for the given hosts.</summary>
      <pattern>
        <e>credential</e>
      </pattern>
    </ele>
        <example>
      <summary>Target without credentials.</summary>
      <e>
        <target>
          <hosts>example.org</hosts>
          <ports>T:22,U:5060</ports>
        </target>
      </e>
    </example>
    <example>
      <summary>Target with two credentials.</summary>
      <e>
        <target>
          <hosts>192.168.1.0/24</hosts>
          <ports>1,2,3,80,443</ports>
          <credentials>
            <credential>...</credential>
            <credential>...</credential>
          </credentials>
        </target>
      </e>
    </example>
  </element>

  <element>
    <name>vt_group</name>
    <summary>Collection of Vulnerability Test</summary>
    <pattern>
      <attrib>
        <name>filter</name>
        <type>string</type>
        <required>1</required>
      </attrib>
    </pattern>
    <example>
      <summary>VT group filtered by family name </summary>
      <e>
        <vt_group filter='family=general'/>
        <vt_group filter='family=debian'/>
      </e>
    </example>
  </element>

  <element>
    <name>vt_selection</name>
    <summary>Contains elements that represent a Vulnerability Test or a collection of Vulnerability Tests to be executed and their parameters</summary>
    <pattern>
      <e>vt_single</e>
      <e>vt_group</e>
    </pattern>
    <example>
      <summary>VT with parameters and VT group </summary>
      <e>
        <vt_selection>
          <vt_single id='1.3.6.1.4.1.25623.1.0.10662'>
            <vt_value id='XYZ JKL'>200</vt_value>
            <vt_value id='ABC'>yes</vt_value>
          </vt_single>
          <vt_single id='1.3.6.1.4.1.25623.1.0.10330'></vt_single>
          <vt_single id='1.3.6.1.4.1.25623.1.0.100034'></vt_single>
          <vt_group filter='family=general'/>
          <vt_group filter='family=debian'/>
        </vt_selection>
      </e>
    </example>
  </element>

  <element>
    <name>vt_single</name>
    <summary>Elements that represent Vulnerability Tests</summary>
    <pattern>
      <attrib>
        <name>vt_id</name>
        <summary>Identifier for a vulnerability test</summary>
        <type>vt_id</type>
        <required>1</required>
      </attrib>
      <e>vt_value</e>
    </pattern>
    <example>
      <summary>VT with parameters</summary>
      <e>
        <vt_single id='1.3.6.1.4.1.25623.1.0.10662'>
          <vt_value id='XYZ JKL'>200</vt_value>
          <vt_value id='ABC'>yes</vt_value>
        </vt_single>
        <vt_single id='1.3.6.1.4.1.25623.1.0.10330'></vt_single>
      </e>
    </example>
  </element>

  <element>
    <name>vt_value</name>
    <summary>Vulnerability Test parameter</summary>
    <pattern>
      <attrib>
        <name>id</name>
        <type>string</type>
        <required>1</required>
      </attrib>
      string
    </pattern>
    <example>
      <summary>Parameters for a single VT</summary>
      <e>
        <vt_value id='XYZ JKL'>200</vt_value>
        <vt_value id='ABC'>yes</vt_value>
      </e>
    </example>
  </element>

  <!-- Commands. -->

  <command>
    <name>help</name>
    <summary>Get the help text</summary>
    <pattern>
      <attrib>
        <name>format</name>
        <summary>Help format</summary>
        <type>
          <alts>
            <alt>xml</alt>
            <alt>text</alt>
          </alts>
        </type>
      </attrib>
    </pattern>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
        text
      </pattern>
    </response>
    <example>
      <summary>Get the help text</summary>
      <request>
        <help format='xml'/>
      </request>
      <response>
        <help_response status_text="OK" status="200">
          <delete_scan>
            <attributes>
              <scan_id>ID of scan to delete</scan_id>
            </attributes>
            <elements></elements>
            <description>Delete a finished scan</description>
          </delete_scan>
          <help>
            <attributes>
              <format>Help format. Could be text or xml</format>
            </attributes>
            <elements></elements>
            <description>Print the commands help</description>
          </help>
          <get_version>
            <attributes></attributes>
            <elements></elements>
            <description>Return various versions</description>
          </get_version>
          <stop_scan>
            <attributes>
              <scan_id>ID of scan stop.</scan_id>
            </attributes>
            <elements></elements>
            <description>Stop a currently running scan.</description>
          </stop_scan>
          <get_scanner_details>
            <attributes></attributes>
            <elements></elements>
            <description>Return scanner description and parameters</description>
          </get_scanner_details>
          <start_scan>
            <attributes>
              <scan_id>Optional UUID value to set as scan ID</scan_id>
              <target>Target hosts to scan in a comma-separated list</target>
              <ports>Ports list to scan as comma-separated list</ports>
              <parallel>Optional number of parallel scans to run</parallel>
            </attributes>
            <elements>
              <scanner_params>
                <profile>Scan profile</profile>
                <target_port>Target port</target_port>
                <use_https>Use HTTPS</use_https>
                <w3af_timeout>w3af scan timeout</w3af_timeout>
              </scanner_params>
            </elements>
            <description>Start a new scan</description>
          </start_scan>
          <stop_scan>
            <attributes>
              <scan_id>ID of scan to stop</scan_id>
            </attributes>
            <description>Stop a currently running scan</description>
          </stop_scan>
          <get_scans>
            <attributes>
              <scan_id>ID of a specific scan to get</scan_id>
              <details>Whether to return the full scan report</details>
              <pop_results>Whether to remove the fetched results</pop_results>
            </attributes>
            <elements></elements>
            <description>List the scans in buffer</description>
          </get_scans>
        </help_response>
      </response>
    </example>
  </command>
  <command>
    <name>get_scans</name>
    <summary>Get the stored scans</summary>
    <pattern>
      <attrib>
        <name>scan_id</name>
        <summary>Scan UUID</summary>
        <type>uuid</type>
      </attrib>
      <attrib>
        <name>details</name>
        <summary>Whether to get full scan reports</summary>
        <type>boolean</type>
      </attrib>
      <attrib>
        <name>pop_results</name>
        <summary>Whether to remove the fetched results</summary>
        <type>boolean</type>
      </attrib>
    </pattern>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
        <e>scan</e>
      </pattern>
      <ele>
        <name>scan</name>
        <pattern>
          <attrib>
            <name>id</name>
            <type>uuid</type>
          </attrib>
          <attrib>
            <name>target</name>
            <type>string</type>
          </attrib>
          <attrib>
            <name>start_time</name>
            <type>epoch_time</type>
          </attrib>
          <attrib>
            <name>end_time</name>
            <type>epoch_time</type>
          </attrib>
          <attrib>
            <name>progress</name>
            <type>integer</type>
          </attrib>
          <e>results</e>
        </pattern>
        <ele>
          <name>results</name>
          <pattern>
            <attrib>
              <name>type</name>
              <type>string</type>
              <summary>One of 'Log Message', 'Alarm', 'Host Detail' or 'Error Message'</summary>
            </attrib>
            <attrib>
              <name>name</name>
              <type>string</type>
              <summary>Result name</summary>
            </attrib>
            <attrib>
              <name>severity</name>
              <type>string</type>
              <summary>Severity of the vulnerability found</summary>
            </attrib>
            <attrib>
              <name>test_id</name>
              <type>vt_id</type>
              <summary>Identifier for a vulnerability test</summary>
            </attrib>
            <attrib>
              <name>value</name>
              <type>string</type>
              <summary>The result message</summary>
            </attrib>
            <attrib>
              <name>host</name>
              <type>string</type>
              <summary>Host associated to the result</summary>
            </attrib>
            <attrib>
              <name>port</name>
              <type>string</type>
              <summary>Port associated to the result</summary>
            </attrib>
            <attrib>
              <name>qod</name>
              <type>string</type>
              <summary>Quality of Detection of the test</summary>
            </attrib>
          </pattern>
        </ele>

      </ele>
    </response>
    <example>
      <summary>Get a scan report summary</summary>
      <request>
        <get_scans scan_id="f14747d3-a4d7-4e79-99bb-a0a1276cb78c" details="1" pop_results="0"/>
      </request>
      <response>
        <get_scans_response status_text="OK" status="200">
          <scan id="9750f1f8-07aa-49cc-9c31-2f9e469c8f65" target="192.168.1.252"
                end_time="1432824234" progress="100" start_time="1432824206">
             <results>
               <result host="192.168.1.252" severity="2.5" port="443/tcp"
                       test_id="" name="Path disclosure vulnerability"
                       type="Alarm">
                 The URL: &quot;https://192.168.1.252/&quot; has a path
                 disclosure vulnerability which discloses "/var/www/phpinfo.php"
                 ...
               </result>
               <result host="192.168.10.130" name="SSL/TLS: Report Supported Cipher Suites"
                       port="5432/tcp" qod="98" severity="0.0"
                       test_id="1.3.6.1.4.1.25623.1.0.802067"
                       type="Log Message">
                 'Strong' cipher suites accepted by this service via the SSLv3 protocol:
                 TLS_DHE_RSA_WITH_AES_256_CBC_SHA'...
               </result>


               ...
             </results>
           </scan>

        </get_scans_response>
      </response>
    </example>
  </command>
  <command>
    <name>delete_scan</name>
    <summary>Delete a finished scan</summary>
    <pattern>
      <attrib>
        <name>scan_id</name>
        <summary>Scan UUID</summary>
        <type>uuid</type>
      </attrib>
    </pattern>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
      </pattern>
    </response>
    <example>
      <summary>Delete a scan successfully</summary>
      <request>
        <delete_scan scan_id="013587e3-b4d7-8e79-9ebb-90a2133c338c"/>
      </request>
      <response>
        <delete_scan_response status_text="OK" status="200"></delete_scan_response>
      </response>
    </example>
  </command>
  <command>
    <name>get_version</name>
    <summary>Return various versions</summary>
    <pattern/>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
        <e>protocol</e>
        <e>daemon</e>
        <e>scanner</e>
      </pattern>
      <ele>
        <name>protocol</name>
        <pattern>
          <e>name</e>
          <e>version</e>
        </pattern>
        <ele>
          <name>version</name>
        </ele>
        <ele>
          <name>name</name>
        </ele>
      </ele>
      <ele>
        <name>daemon</name>
        <pattern>
          <e>name</e>
          <e>version</e>
        </pattern>
        <ele>
          <name>version</name>
        </ele>
        <ele>
          <name>name</name>
        </ele>
      </ele>
      <ele>
        <name>scanner</name>
        <pattern>
          <e>name</e>
          <e>version</e>
        </pattern>
        <ele>
          <name>version</name>
        </ele>
        <ele>
          <name>name</name>
        </ele>
      </ele>
    </response>
    <example>
      <summary>Get protocol, scanner and daemon versions</summary>
      <request>
        <get_version/>
      </request>
      <response>
        <get_version_response status_text="OK" status="200">
          <protocol>
            <version>1.0</version>
            <name>OSP</name>
          </protocol>
          <daemon>
            <version>generic version</version>
            <name>generic ospd</name>
          </daemon>
          <scanner>
            <version>1.6.0.4</version>
            <name>w3af</name>
          </scanner>
        </get_version_response>
      </response>
    </example>
  </command>
  <command>
    <name>get_scanner_details</name>
    <summary>Return scanner description and parameters</summary>
    <pattern/>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
        <e>description</e>
        <e>scanner_params</e>
      </pattern>
      <ele>
        <name>description</name>
        <pattern></pattern>
      </ele>
      <ele>
        <name>scanner_params</name>
        <pattern>
          <any><e>scanner_param</e></any>
        </pattern>
        <ele>
          <name>scanner_param</name>
          <pattern>
            <attrib>
              <name>id</name>
              <type>string</type>
            </attrib>
            <attrib>
              <name>type</name>
              <type>string</type>
            </attrib>
            <e>name</e>
            <e>description</e>
            <e>default</e>
            <e>mandatory</e>
          </pattern>
          <ele>
            <name>name</name>
          </ele>
          <ele>
            <name>description</name>
          </ele>
          <ele>
            <name>default</name>
          </ele>
          <ele>
            <name>mandatory</name>
          </ele>
        </ele>
      </ele>
    </response>
    <example>
      <summary>Get scanner details</summary>
      <request>
        <get_scanner_details/>
      </request>
      <response>
        <get_scanner_details_response status_text="OK" status="200">
          <description>
            ...
          </description>
          <scanner_params>
            <scanner_param id="profile" type="selection">
              <name>Scan profile</name>
              <description>Scan profiles are predefined set of plugins and customized configurations.</description>
              <default>fast_scan|fast_scan|audit_high_risk|full_audit|OWASP_TOP10|bruteforce|empty_profile|web_infrastructure|full_audit_spider_man|sitemap</default>
            </scanner_param>
            <scanner_param id="http_request_status" type="boolean">
              <name>Show HTTP request status</name>
              <description>Whether to show the HTTP request&apos;s status in results</description>
              <default>0</default>
            </scanner_param>
            <scanner_param id="dry_run" type="boolean">
              <name>Dry Run</name>
              <description>Whether to dry run scan.</description>
              <default>0</default>
            </scanner_param>
            <scanner_param id="http_request_headers" type="boolean">
              <name>Show HTTP request headers</name>
              <description>Whether to show the HTTP request&apos;s headers in results</description>
              <default>0</default>
            </scanner_param>
            <scanner_param id="http_response_status" type="boolean">
              <name>Show HTTP response status</name>
              <description>Whether to show the HTTP response&apos;s status in results</description>
              <default>0</default>
            </scanner_param>
            <scanner_param id="seed_path" type="string">
              <name>Seed path</name>
              <description>Path to start with</description>
              <default>/</default>
            </scanner_param>
            <scanner_param id="debug_mode" type="boolean">
              <name>Debug Mode</name>
              <description>Whether to get extra scan debug information.</description>
              <default>0</default>
            </scanner_param>
            <scanner_param id="target_port" type="integer">
              <name>Target port</name>
              <description>Port on target host to scan</description>
              <default>80</default>
            </scanner_param>
            <scanner_param id="use_https" type="boolean">
              <name>Use HTTPS</name>
              <description>Whether the target application is running over HTTPS</description>
              <default>0</default>
            </scanner_param>
          </scanner_params>
        </get_scanner_details_response>
      </response>
    </example>
  </command>

  <command>
    <name>get_vts</name>
    <summary>Return information about vulnerability tests, if offered by scanner</summary>
    <pattern>
      <attrib>
        <name>vt_id</name>
        <summary>Identifier for vulnerability test</summary>
        <type>vt_id</type>
      </attrib>
    </pattern>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
        <e>vts</e>
      </pattern>
      <ele>
        <name>vts</name>
        <pattern>
          <any><e>vt</e></any>
        </pattern>
        <ele>
          <name>vt</name>
          <pattern>
            <attrib>
              <name>id</name>
              <type>vt_id</type>
            </attrib>
            <e>name</e>
            <e>creation_time</e>
            <e>modification_time</e>
            <e>vt_params</e>
            <e>vt_refs</e>
            <e>dependencies</e>
            <e>summary</e>
            <e>impact</e>
            <e>affected</e>
            <e>insight</e>
            <e>solution</e>
            <e>detection</e>
            <e>severities</e>
            <e>custom</e>
          </pattern>
          <ele>
            <name>name</name>
          </ele>
          <ele>
            <creation_time>creation_time</creation_time>
          </ele>
          <ele>
            <modification_time>modification_time</modification_time>
          </ele>
          <ele>
            <name>vt_params</name>
          </ele>
          <ele>
            <name>vt_refs</name>
            <pattern>
              <e>ref</e>
            </pattern>
            <ele>
              <name>ref</name>
              <pattern>
                <attrib>
                    <name>type</name>
                    <type>string</type>
                </attrib>
                <attrib>
                  <name>id</name>
                  <type>string</type>
                </attrib>
              </pattern>
            </ele>
          </ele>
          <ele>
            <name>dependencies</name>
          </ele>
          <ele>
            <name>summary</name>
          </ele>
          <ele>
            <name>impact</name>
          </ele>
          <ele>
            <name>affected</name>
          </ele>
          <ele>
            <name>insight</name>
          </ele>
          <ele>
            <name>solution</name>
          </ele>
          <ele>
            <name>detection</name>
          </ele>
          <ele>
            <name>severities</name>
            <pattern>
              <e>seveirty</e>
            </pattern>
            <ele>
              <name>seveirty</name>
              <pattern>
                <attrib>
                  <name>type</name>
                  <type>string</type>
                </attrib>
                <attrib>
                  <name>origin</name>
                  <summary>Optional reference to the origin of the severity</summary>
                  <type>string</type>
                </attrib>
              </pattern>
            </ele>
          </ele>
          <ele>
            <name>custom</name>
          </ele>
        </ele>
      </ele>
    </response>
    <example>
      <summary>Get information for all available vulnerability tests</summary>
      <request>
        <get_vts/>
      </request>
      <response>
        <get_vts_response status_text="OK" status="200">
          <vts>
            <vt id="1.2.3.4.5">
              <name>Check for presence of vulnerability X</name>
            </vt>
            <vt id="ad45h67">
              <name>Check for presence of vulnerability Y</name>
            </vt>
          </vts>
        </get_vts_response>
      </response>
    </example>
    <example>
      <summary>Get information for a single vulnerability test</summary>
      <request>
        <get_vts vt_id='1.2.3.4.5'/>
      </request>
      <response>
        <get_vts_response status_text="OK" status="200">
          <vts>
            <vt id="1.2.3.4.5">
              <name>Check for presence of vulnerability X</name>
              <vt_refs>
                <ref id="2014-16494" type="fedora" />
                <ref id="https://lists.fedoraproject.org/" type="url" />
                <ref id="CVE-2014-9116" type="cve" />
              </vt_refs>
              <dependencies>
                <dependency vt_id="1.3.6.1.4.1.25623.1.0.50282" />
              </dependencies>
              <creation_time>2015-02-15 05:47:27 +0100 (Sun, 15 Feb 2015)</creation_time>
              <modification_time>$Date: 2017-07-10 08:34:32 +0200 (Mon, 10 Jul 2017) $</modification_time>
              <summary>Check the version of App</summary>
              <affected>App in OS v2</affected>
              <insight>App is a small but very powerful app.</insight>
              <solution type="VendorFix">Please Install the Updated Packages.
              </solution>
              <detection qod_type="package">Get the installed version with the help of detect NVT and check if the version is vulnerable or not.</detection>
              <severities>
                <severity type="cvss_base_v2" origin="CVE-2014-9116">AV:N/AC:L/Au:N/C:N/I:N/A:P</severity>
              </severities>
            </vt>
          </vts>
        </get_vts_response>
      </response>
    </example>
    <example>
      <summary>Get information for a vulnerability test with custom data</summary>
      <request>
        <get_vts vt_id='1.2.3.4.5'/>
      </request>
      <response>
        <get_vts_response status_text="OK" status="200">
          <vts>
            <vt id="1.2.3.4.5">
              <name>Check for presence of vulnerability X</name>
              <custom>
                <my_element>First custom element</my_element>
                <my_other_element>second custom element</my_other_element>
              </custom>
            </vt>
          </vts>
        </get_vts_response>
      </response>
    </example>
    <example>
      <summary>Get information for a vulnerability test with VT parameters data</summary>
      <request>
        <get_vts vt_id='1.2.3.4.5'/>
      </request>
      <response>
        <get_vts_response status_text="OK" status="200">
          <vts>
            <vt id="1.2.3.4.5">
              <name>Check for presence of vulnerability X</name>
              <vt_params>
                <vt_param id="timeout" type="integer">
                  <name>Timeout</name>
                  <description>Vulnerability Test Timeout</description>
                  <default>300</default>
                </vt_param>
                <vt_param id="scan.udp" type="boolean">
                  <name>Scan UDP</name>
                  <description />
                  <default>1</default>
                </vt_param>
              </vt_params>
              <vt_refs>
                <ref type="cve" id="CVE-2010-4480"/>
                <ref type="url" id="http://www.exploit-db.com/exploits/15699/"/>
                <ref type="url" id="http://www.vupen.com/english/advisories/2010/3133"/>
              </vt_refs>
              <custom>
                <my_element>First custom element</my_element>
                <my_other_element>second custom element</my_other_element>
              </custom>
            </vt>
          </vts>
        </get_vts_response>
      </response>
    </example>
  </command>

  <command>
    <name>start_scan</name>
    <summary>Start a new scan</summary>
    <pattern>
      <attrib>
        <name>target</name>
        <summary>Target hosts to scan in a comma-separated list</summary>
        <type>string</type>
      </attrib>
      <attrib>
        <name>ports</name>
        <summary>Ports list to scan as comma-separated list</summary>
        <type>string</type>
      </attrib>
      <attrib>
        <name>scan_id</name>
        <summary>Optional UUID value to use as scan ID</summary>
        <type>uuid</type>
      </attrib>
      <attrib>
        <name>parallel</name>
        <summary>Optional number of parallel scan to run </summary>
        <type>integer</type>
      </attrib>
      <e>scanner_params</e>
      <e>vt_selection</e>
      <e>targets</e>
    </pattern>
    <ele>
      <name>scanner_params</name>
      <summary>Contains elements that represent scanner specific parameters</summary>
    </ele>
    <ele>
      <name>vt_selection</name>
      <summary>Contains elements that represent a Vulnerability Test or a collection of Vulnerability Tests to be executed and their parameters</summary>
    </ele>
    <ele>
      <name>targets</name>
      <summary>Contains elements that represent a target to execute a scan against. If target and port attributes are present this element is not take into account</summary>
    </ele>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
        <e>id</e>
      </pattern>
      <ele>
        <name>id</name>
        <summary>New scan's UUID</summary>
      </ele>
    </response>
    <example>
      <summary>Start a new scan. Legacy mode</summary>
      <request>
        <start_scan target='localhost' ports='80, 443'>
          <scanner_params>
            <target_port>443</target_port>
            <use_https>1</use_https>
            <profile>fast_scan</profile>
          </scanner_params>
        </start_scan>
      </request>
      <response>
        <start_scan_response status_text="OK" status="200">
          <id>2f616d53-595f-4785-9b97-4395116ca118</id>
        </start_scan_response>
      </response>
    </example>
    <example>
      <summary>Start a new scan with multi-targets running simultaneously. Each one has a different port list and one of them has credentials for authenticated scans.</summary>
      <request>
        <start_scan parallel='10'>
          <scanner_params>
            ...
          </scanner_params>
          <vt_selection>
            ....
          </vt_selection>
          <targets>
            <target>
              ...
            </target>
            <target>
              <hosts>192.168.1.0/24</hosts>
              <ports>1,2,3,80,443</ports>
              <credentials>
                ...
              </credentials>
            </target>
          </targets>
        </start_scan>
      </request>
      <response>
        <start_scan_response status_text="OK" status="200">
          <id>2f616d53-595f-4785-9b97-4395116ca118</id>
        </start_scan_response>
      </response>
    </example>
  </command>

  <command>
    <name>stop_scan</name>
    <summary>Stop a currently running scan</summary>
    <pattern>
      <attrib>
        <name>scan_id</name>
        <summary>ID of scan to stop</summary>
        <type>uuid</type>
      </attrib>
    </pattern>
    <response>
      <pattern>
        <attrib>
          <name>status</name>
          <type>status</type>
          <required>1</required>
        </attrib>
        <attrib>
          <name>status_text</name>
          <type>text</type>
          <required>1</required>
        </attrib>
      </pattern>
    </response>
    <example>
      <summary>Stop a scan</summary>
      <request>
        <stop_scan scan_id='6ec1732c-10e8-448c-90fb-7797ad47ada2'>
        </stop_scan>
      </request>
      <response>
        <stop_scan_response status_text="OK" status="200">
        </stop_scan_response>
      </response>
    </example>
  </command>
  <parameter_type>
    <name>integer</name>
    <summary>An integer value</summary>
  </parameter_type>
  <parameter_type>
    <name>string</name>
    <summary>A string</summary>
  </parameter_type>
  <parameter_type>
    <name>boolean</name>
    <summary>0 or 1</summary>
  </parameter_type>
  <parameter_type>
    <name>selection</name>
    <summary>A value out of the | separated values list</summary>
  </parameter_type>
  <parameter_type>
    <name>credential_up</name>
    <summary>The username:password of a credential</summary>
  </parameter_type>
  <parameter_type>
    <name>file</name>
    <summary>A file's content</summary>
  </parameter_type>
  <parameter_type>
    <name>ovaldef_file</name>
    <summary>An ovaldef file's content that is base64 encoded</summary>
  </parameter_type>

  <change>
    <command>GET_VTS</command>
    <summary>command added</summary>
    <description>
      Added new command to retrieve information about vulnerability tests a scanner might offer.
    </description>
    <version>1.2</version>
  </change>
  <change>
    <command>START_SCAN</command>
    <summary>vts optional element added </summary>
    <description>
      Added optional element vts to allow the client to specify a vts list
      to use for the scan and their parameters.
    </description>
    <version>1.2</version>
  </change>
  <change>
    <command>START_SCAN</command>
    <summary>target optional element added </summary>
    <description>
      Added optional element targets to specify different hosts with a different port list and credentials. This is take in account only if target and port attributes are not present in start_scan tag.
    </description>
    <version>1.2</version>
  </change>
  <change>
    <command>START_SCAN</command>
    <summary> parallel attribute added </summary>
    <description>
      Added optional attribute parallel to specify the number of simultaneous scans to be run.
    </description>
    <version>1.2</version>
  </change>

  <change>
    <command>STOP_SCAN</command>
    <summary>command added</summary>
    <description>
      Added new command to stop a currently running scan.
    </description>
    <version>1.1</version>
  </change>
  <change>
    <command>START_SCAN</command>
    <summary>scan_id attribute added</summary>
    <description>
      <p>
        The scan_id attribute was added to allow the client to specify a UUID as
        the ID of the scan.
      </p>
    </description>
    <version>1.1</version>
  </change>
  <change>
    <command>START_SCAN</command>
    <summary>ports attribute added</summary>
    <description>
      The ports attribute was added to allow the client to specify a ports list
      to use for the scan.
    </description>
    <version>1.1</version>
  </change>
  <change>
    <command>Scanner Parameters Types</command>
    <summary>Type credential_up added</summary>
    <description>
      Introduce an aggregated type to express a username:password tuple.
    </description>
    <version>1.1</version>
  </change>
</protocol>
